left side: DataProto(batch=TensorDict(
    fields={
        attention_mask: Tensor(shape=torch.Size([256, 497]), device=cpu, dtype=torch.int64, is_shared=False),
        input_ids: Tensor(shape=torch.Size([256, 497]), device=cpu, dtype=torch.int64, is_shared=False),
        position_ids: Tensor(shape=torch.Size([256, 497]), device=cpu, dtype=torch.int64, is_shared=False)},
    batch_size=torch.Size([256]),
    device=None,
    is_shared=False), non_tensor_batch={}, meta_info={})
left side shape: torch.Size([256, 497])
left side decoded: You are a Sokoban solver.

Sokoban Quick Guide
Goal: Push all boxes (X) onto targets (O).

Symbols:
# Wall | _ Floor | O Target | X Box | P You
âˆš = Box on Target | S = You on Target

Rules:
1. Push boxes (canâ€™t pull).
2. Avoid walls (#).
3. Donâ€™t trap boxes in corners.

Controls:
1 (Up) | 2 (Down) | 3 (Left) | 4 (Right)

Rewards:
Move: -0.1
Box on target: +1.0
All boxes placed: +10.0

**Answer format**:
**Respond in 2 steps**:
1. **Think**: Analyze map, risks, and best move.
2. **Reply ONLY**:
   Thoughts: [1-line strategy]
   Action: [1/2/3/4]

Tip: Plan moves ahead to avoid stuck boxes.
Win when all X become âˆš! ðŸŽ¯ 

[Cumulative Observations]:
 # 	 # 	 # 	 # 	 # 	 # 	
 # 	 _ 	 _ 	 # 	 # 	 # 	
 # 	 X 	 _ 	 # 	 # 	 # 	
 # 	 O 	 _ 	 # 	 _ 	 # 	
 # 	 O 	 _ 	 X 	 P 	 # 	
 # 	 # 	 # 	 # 	 # 	 # 	
Decide the next action: Reference the strategy on Cumulative Observations.

Step 1: Analyze the map and identify key moving actions.

### Key Observations and Strategies
Objects with a plus (+1) at the end are boxes that can be popped:
- Box on target (complementary to Box in Floor)
- All boxes (object with a +1)
- Target (corner)
- Moving To Key - (object with a +1)

Key strategies are:
1. Box Pop - Collect all boxes on the floor
2. Goal Move - Push all boxes onto the top floor
3. Side moves - Aim for peaceful placement on left/right sides
4. Continue Pushing Move - Move higher for additional boxes

Step 2: Think through the best next actions.

**Thoughts:**

1. **Initial Moves**: Ideally, we need to move to the place where all boxes are placed before any attempts to push them. Our best move is to face the boxes directly towards them. This would minimize
